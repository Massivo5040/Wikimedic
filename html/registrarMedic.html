<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Medicamentos</title>
</head>

<body>

    <h1>Validar Registro de Medicamento</h1>

    <form id="medicationForm">
        <label for="name">Nome:</label>
        <input type="text" id="name" name="name" required><br>

        <label for="numRegistro">Número de Registro:</label>
        <input type="text" id="numRegistro" name="numRegistro" required><br>

        <label for="indicacao">Indicação:</label>
        <textarea id="indicacao" name="indicacao" rows="4" required></textarea><br>

        <label for="contraindicacao">Contraindicação:</label>
        <textarea id="contraindicacao" name="contraindicacao" rows="4" required></textarea><br>

        <label for="categoria">Categoria:</label>
        <input type="text" id="categoria" name="categoria" required><br>

        <label for="cuidados">Cuidados:</label>
        <textarea id="cuidados" name="cuidados" rows="4" required></textarea><br>

        <label for="reacao_adversa">Reação Adversa:</label>
        <textarea id="reacao_adversa" name="reacao_adversa" rows="4" required></textarea><br>

        <label for="posologia">Posologia:</label>
        <textarea id="posologia" name="posologia" rows="4" required></textarea><br>

        <label for="riscos">Riscos:</label>
        <textarea id="riscos" name="riscos" rows="4" required></textarea><br>

        <label for="especiais">Pacientes Especiais:</label>
        <textarea id="especiais" name="especiais" rows="4" required></textarea><br>

        <label for="superdose">Superdose:</label>
        <textarea id="superdose" name="superdose" rows="4" required></textarea><br>

        <button type="button" id="registrar">Registrar Medicamento</button>
    </form>

    <h1>Update Medicamentos</h1>

    <form id="medicationForm">
        <label for="update-name">Nome:</label>
        <input type="text" id="update-name" name="update-"><br>

        <label for="update-numRegistro">Número de Registro:</label>
        <input type="text" id="update-numRegistro" name="update-numRegistro" required><br>

        <label for="update-indicacao">Indicação:</label>
        <textarea id="update-indicacao" name="update-indicacao" rows="4"></textarea><br>

        <label for="update-contraindicacao">Contraindicação:</label>
        <textarea id="update-contraindicacao" name="update-contraindicacao" rows="4"></textarea><br>

        <label for="update-categoria">Categoria:</label>
        <input type="text" id="update-categoria" name="update-categoria"><br>

        <label for="update-cuidados">Cuidados:</label>
        <textarea id="update-cuidados" name="update-cuidados" rows="4"></textarea><br>

        <label for="update-reacao_adversa">Reação Adversa:</label>
        <textarea id="update-reacao_adversa" name="update-reacao_adversa" rows="4"></textarea><br>

        <label for="update-posologia">Posologia:</label>
        <textarea id="update-posologia" name="update-posologia" rows="4"></textarea><br>

        <label for="update-riscos">Riscos:</label>
        <textarea id="update-riscos" name="update-riscos" rows="4"></textarea><br>

        <label for="update-especiais">Especiais:</label>
        <textarea id="update-especiais" name="update-especiais" rows="4"></textarea><br>

        <button type="button" id="atualizar">Atualizar Medicamento</button>
    </form>

    <script>
        async function registerMedication() {
            const medicationData = {
                name: document.getElementById('name').value,
                numRegistro: document.getElementById('numRegistro').value,
                indicacao: document.getElementById('indicacao').value,
                contraindicacao: document.getElementById('contraindicacao').value,
                categoria: document.getElementById('categoria').value,
                cuidados: document.getElementById('cuidados').value,
                reacao_adversa: document.getElementById('reacao_adversa').value,
                posologia: document.getElementById('posologia').value,
                riscos: document.getElementById('riscos').value,
                especiais: document.getElementById('especiais').value,
                superdose : document.getElementById('superdose').value
            };

            const response = await fetch('https://server-wikimedic.onrender.com/medicamentos/validate', {
                method: 'POST',
                headers: {
                    'Content-type': 'application/json; charset=UTF-8',
                },
                body: JSON.stringify(medicationData),
            });

            if (response.ok) {
                console.log('Sucesso');
                const json = await response.json()
                console.log(json)
                alert('Sucesso. ' + json.validacao_status)
            } else {
                console.log('Algo deu errado');
            }
        }
        document.querySelector('#registrar').addEventListener('click', registerMedication)

        async function updateMedic() {
            const num = prompt('Digite o numProcesso atual do Medicamento a ser Atualizado.')
            const medicationData = {
                numRegistro: num,
                newMedic: {
                    name: document.getElementById('update-name').value,
                    indicacao: document.getElementById('update-indicacao').value,
                    contraindicacao: document.getElementById('update-contraindicacao').value,
                    categoria: document.getElementById('update-categoria').value,
                    cuidados: document.getElementById('update-cuidados').value,
                    reacao_adversa: document.getElementById('update-reacao_adversa').value,
                    posologia: document.getElementById('update-posologia').value,
                    riscos: document.getElementById('update-riscos').value,
                    especiais: document.getElementById('update-especiais').value,
                }
            };

            const response = await fetch('https://server-wikimedic.onrender.com/medicamentos/update', {
                method: 'POST',
                headers: {
                    'Content-type': 'application/json; charset=UTF-8',
                },
                body: JSON.stringify(medicationData),
            });

            if (response.ok) {
                console.log('Sucesso');
                const json = await response.json()
                console.log(json)
                alert('Sucesso. ')
            } else {
                console.log('Algo deu errado');
                console.log(await response.json())
                alert('Algo deu Errado!!.')
            }
        }
        document.querySelector('#atualizar').addEventListener('click', updateMedic)
    </script>

</body>

</html>